preprocess:
  openimages:
    num_processes: 5
    data_save_path: ./tmp_data
    base_file_folder_name: base_files
    images_folder_name: data/images
    masks_folder_name: data/masks
    vae_image_features_folder_name: vae_image_features
    vae_image_wmask_features_folder_name: vae_image_wmask_features
    mask_data_url: https://storage.googleapis.com/openimages/v5/<SET_NAME>-annotations-object-segmentation.csv
    segmentation_masks_base_url: https://storage.googleapis.com/openimages/v5/<SET_NAME>-masks/<SET_NAME>-masks-<ID>.zip
    bounding_boxes_base_url: https://storage.googleapis.com/openimages/v5/<SET_NAME>-annotations-bbox.csv
    image_id_base_url: https://storage.googleapis.com/openimages/2018_04/<SET_NAME>/<SET_NAME>-images-with-rotation.csv
    id_list: ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"]
  
  mask_controller:
    min_mask_area_ratio: 0.02
    max_mask_area_ratio: 0.8

train:
  batch_size: 2
  num_epochs: 100
  max_train_steps: 100000
  save_model_steps: 10000
  num_workers: 4
  learning_rate: 2e-5
  adam_beta1: 0.9
  adam_beta2: 0.999
  weight_decay: 3e-2
  adam_epsilon: 1e-08
  mixed_precision: fp16
  gradient_accumulation_steps: 1
  work_dir: ./output
  gradient_clip: 1.
  vae_pretrained_model: madebyollin/sdxl-vae-fp16-fix
  object_encoder_model: facebook/dinov2-small
  diffusers_model: PixArt-alpha/PixArt-XL-2-512x512

  train_sampling_steps: 1000
  learn_sigma: False
  pred_sigma: False
  snr_loss: False

  dataset:
    target_size: [512, 512]
    perturbation_cfg:
      blur_cfg:
        p: 0.3
      color_jitter_cfg:
        brightness: 0.3
        contrast: 0.3
        saturation: 0.3
        hue: 0.05
        p: 1
      horizontal_flip_cfg:
        p: 0 #.5
      rotate_cfg:
        limit: 20
        border_mode: 0
        fill: [127, 127, 127]
        fill_mask: 0
        p: 1
      perspective_cfg:
        scale: [0.01, 0.1]
        border_mode: 0
        fill: [127, 127, 127]
        fill_mask: 0
        fit_output: False

logging:
  version: 1
  disable_existing_loggers: False
  formatters:
    simple:
      format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
  handlers:
    console:
      class: logging.StreamHandler
      level: DEBUG
      formatter: simple
      stream: ext://sys.stdout
    file:
      class: logging.handlers.RotatingFileHandler
      level: INFO
      formatter: simple
      filename: output.log
      maxBytes: 10485760  # 10 MB
      backupCount: 5
  loggers:
    lazyobjectplacement:
      level: DEBUG
      handlers: [console, file]
      propagate: no